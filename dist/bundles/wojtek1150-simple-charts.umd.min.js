!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/platform-browser"),require("@angular/common")):"function"==typeof define&&define.amd?define("@wojtek1150/simple-charts",["exports","@angular/core","@angular/platform-browser","@angular/common"],e):e(((t=t||self).wojtek1150=t.wojtek1150||{},t.wojtek1150["simple-charts"]={}),t.ng.core,t.ng.platformBrowser,t.ng.common)}(this,(function(t,e,i,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var a in e=arguments[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};var r=function(t,e){return Math.round((e-t)/864e5)},o=function(t,e){return t.sort((function(t,i){return t[e]>i[e]?1:i[e]>t[e]?-1:0}))},s=function(t,e){return t.reduce((function(t,i){return t[e]>=i[e]?t:i}),{})},l=function(t){if(t<=15)return{maxValue:15,scaleY:[15,10,5]};if(t<=30)return{maxValue:30,scaleY:[30,20,10]};if(t<=45)return{maxValue:45,scaleY:[45,30,15]};if(t<=60)return{maxValue:60,scaleY:[60,40,20]};if(t<=120)return{maxValue:120,scaleY:[120,80,40]};var e=100*Math.ceil(t/100),i=10*Math.ceil(e/3/10);return{maxValue:e,scaleY:[e,e-i,e-i-i]}};var p=function(t){var e=this;this.points=[],this.pillars=[],t&&t.length>0&&(this.points=o(t.map((function(t){return{value:t.value,time:new Date(t.time)}})),"time"),this.xScale=1.1*this.points.reduce((function(t,e){return t.value>=e.value?t:e}),{value:0}).value,this.startPoint=this.points.slice(0,1)[0].time,this.endPoint=this.points.slice(-1)[0].time,this.days=r(this.startPoint,this.endPoint),this.pillars=this.points.map((function(t,i,n){if(0===i)return{};var o={startValue:Math.floor(n[i-1].value/e.xScale*100),endValue:Math.floor(t.value/e.xScale*100),startPosition:r(e.startPoint,n[i-1].time),endPosition:r(e.startPoint,t.time)};return a({},o,{width:Math.floor((o.endPosition-o.startPosition)/e.days*100)})})).slice(1))};var d=function(){function t(t){this.sanitizer=t}return Object.defineProperty(t.prototype,"points",{set:function(t){this.chart=new p(t)},enumerable:!0,configurable:!0}),t.prototype.shape=function(t){var e="polygon(0 "+(100-t.startValue)+"%, 100% "+(100-t.endValue)+"%, 100% 100%, 0% 100%)";return this.sanitizer.bypassSecurityTrustStyle(e)},t.prototype.line=function(t){var e="polygon(0 "+(100-t.startValue)+"%, 100% "+(100-t.endValue)+"%, 100% "+(102-t.endValue)+"%, 0 "+(102-t.startValue)+"%)";return this.sanitizer.bypassSecurityTrustStyle(e)},t.decorators=[{type:e.Component,args:[{selector:"lib-line-chart",template:'<div class="pillar" *ngFor="let pillar of chart.pillars" [style.width]="pillar.width + \'%\'">\n  <div class="clip-path" [style.clip-path]="shape(pillar)"></div>\n  <div class="line" [style.clip-path]="line(pillar)"></div>\n</div>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,styles:[":host{background-image:-webkit-gradient(linear,left top,left bottom,color-stop(.1em,rgba(255,255,255,.07)),color-stop(.1em,transparent)),-webkit-gradient(linear,left top,right top,color-stop(.1em,rgba(255,255,255,.07)),color-stop(.1em,transparent));background-image:linear-gradient(rgba(255,255,255,.07) .1em,transparent .1em),linear-gradient(90deg,rgba(255,255,255,.07) .1em,transparent .1em);background-size:1em 1em;box-sizing:border-box;display:-webkit-box;display:flex;height:200px;width:100%}:host .pillar{box-sizing:border-box;height:100%;position:relative}:host .clip-path{background:-webkit-gradient(linear,left top,left bottom,from(white),color-stop(50%,rgba(255,255,255,.4)),to(rgba(255,255,255,0)));background:linear-gradient(180deg,#fff 0,rgba(255,255,255,.4) 50%,rgba(255,255,255,0) 100%);height:100%;position:relative;-webkit-transition:-webkit-clip-path .3s ease-in-out;transition:clip-path .3s ease-in-out;transition:clip-path .3s ease-in-out,-webkit-clip-path .3s ease-in-out;width:100%;z-index:1}:host .line{background:#fff;height:100%;left:0;position:absolute;top:0;width:100%;z-index:1}"]}]}],t.ctorParameters=function(){return[{type:i.DomSanitizer}]},t.propDecorators={points:[{type:e.Input}]},t}();var c={numbers:"numbers",percents:"percents"};var u=function(t){var e=this;if(this.lines=[],t&&t.length>0){var i=t.filter((function(t){return t.valueType===c.numbers}));if(!i.length)throw Error("You must provide at least one number type line");var n=i.map((function(t){return s(t.items,"y")})),a=l(s(n,"y").y);this.maxValue=a.maxValue,this.scaleY=a.scaleY,this.scaleX=t[0].items.map((function(t){return t.x})),this.lines=t.map((function(t){return{label:t.label,lineType:t.lineType,valueType:t.valueType,items:g(t.items,e.maxValue,t.valueType===c.percents)}}))}};function g(t,e,i){return o(t,"x").map((function(t,n,a){if(0!==n)return{x:t.x,y:t.y,shapeStart:i?a[n-1].y:Math.floor(a[n-1].y/e*100),shapeEnd:i?t.y:Math.floor(t.y/e*100)}})).slice(1)}var h=function(){function t(t){this.sanitizer=t}return Object.defineProperty(t.prototype,"data",{set:function(t){this.chart=new u(t),console.log("MultiLineChartComponent",t,this.chart)},enumerable:!0,configurable:!0}),t.prototype.segmentPath=function(t){var e="polygon(0 "+(100-t.shapeStart)+"%, 100% "+(100-t.shapeEnd)+"%, 100% "+(101-t.shapeEnd)+"%, 0 "+(101-t.shapeStart)+"%)";return this.sanitizer.bypassSecurityTrustStyle(e)},t.prototype.dotLocation=function(t){return this.sanitizer.bypassSecurityTrustStyle(t.shapeEnd+"%")},t.decorators=[{type:e.Component,args:[{selector:"lib-multi-line-chart",template:'<div class="chart">\n\n  <div class="left axis-y">\n    <span *ngFor="let y of chart.scaleY">{{y}}</span>\n  </div>\n\n  <div class="lines">\n    <div class="line" *ngFor="let line of chart.lines">\n\n      <div class="segment {{line.lineType}}" *ngFor="let pillar of line.items">\n        <div class="shape" [style.clip-path]="segmentPath(pillar)"></div>\n        <div class="dot" [style.bottom]="dotLocation(pillar)">\n          <span>{{pillar.y}}{{line.valueType === \'percents\' ? \'%\' : \'\'}}</span>\n        </div>\n      </div>\n\n    </div>\n\n    <div class="grid">\n      <div class="column" *ngFor="let x of chart.scaleX">\n        <div class="row" *ngFor="let y of chart.scaleY"></div>\n      </div>\n    </div>\n  </div>\n\n  <div class="right axis-y">\n    <span>100%</span>\n    <span>75%</span>\n    <span>50%</span>\n    <span>25%</span>\n  </div>\n\n  <div class="axis-x">\n    <span>&nbsp;</span>\n    <span *ngFor="let x of chart.scaleX">{{x}}</span>\n  </div>\n\n</div>\n\n<div class="legend">\n  <div class="item" *ngFor="let line of chart.lines">\n    <div class="icon {{line.lineType}}"></div>\n    {{line.label}}\n  </div>\n</div>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,styles:[':host{background:#4266e3;border-radius:5px;color:#fff;display:block;margin:10px 0}.chart{display:-ms-grid;display:grid;font-size:12px;-ms-grid-columns:40px auto 45px;grid-template-columns:40px auto 45px}.chart .axis-y{display:-ms-grid;display:grid;padding-top:10px}.chart .axis-y.left{-ms-grid-rows:33% 32% 32%;grid-template-rows:33% 32% 32%;padding-left:12px}.chart .axis-y.right{-ms-grid-rows:24% 25% 25% 26%;grid-template-rows:24% 25% 25% 26%;padding-left:5px}.chart .axis-x{display:-webkit-box;display:flex;-ms-grid-column:2;grid-column:2;-webkit-box-pack:justify;justify-content:space-between;margin:10px -2px 15px 0;text-align:center}.lines{border-bottom:1px solid rgba(255,255,255,.7);border-left:1px solid rgba(255,255,255,.7);box-sizing:border-box;display:block;height:175px;position:relative;width:100%}.grid,.line{bottom:0;display:-webkit-box;display:flex;-webkit-box-pack:stretch;justify-content:stretch;left:0;position:absolute;right:0}.line{top:20px;z-index:1}.grid{top:0;z-index:0}.grid .column{border-right:1px solid rgba(255,255,255,.2);display:-ms-grid;display:grid;-webkit-box-flex:1;flex:1;-ms-grid-rows:(1fr)[3];grid-template-rows:repeat(3,1fr);padding-top:20px}.grid .column .row{border-top:1px solid rgba(255,255,255,.2)}.segment{box-sizing:border-box;display:block;-webkit-box-flex:1;flex:1;height:100%;position:relative}.segment .shape{height:100%;position:absolute;width:100%}.segment .dot{background:#6dd5b4;border-radius:50%;cursor:pointer;display:block;height:8px;position:absolute;right:0;-webkit-transform:translate(50%,50%);transform:translate(50%,50%);visibility:hidden;width:8px;z-index:2}.segment .dot span{background:#222;border-radius:3px;display:block;font-size:10px;left:50%;opacity:0;padding:3px 6px;position:absolute;-webkit-transform:translate(-50%,-120%);transform:translate(-50%,-120%);-webkit-transition:opacity .3s ease-in-out;transition:opacity .3s ease-in-out;z-index:3}.segment .dot:hover span{opacity:1}.segment.normal .shape{background:rgba(255,255,255,.6)}.segment.points .shape{background:#6dd5b4}.segment.points .dot{visibility:visible}.segment.dashed .shape{background-image:-webkit-gradient(linear,left top,right top,color-stop(50%,#fff),color-stop(50%,transparent));background-image:linear-gradient(to right,#fff 50%,transparent 50%);background-repeat:repeat;background-size:3px 100%}.legend{display:-webkit-box;display:flex;font-size:11px;-webkit-box-pack:justify;justify-content:space-between}.legend .item{display:-ms-grid;display:grid;-ms-grid-columns:25px auto;grid-template-columns:25px auto;padding:5px}.legend .icon{height:1px;margin-top:8px;position:relative;width:17px}.legend .icon.normal{background:rgba(255,255,255,.6)}.legend .icon.dashed{border-bottom:1px dashed #fff}.legend .icon.points{background:#6dd5b4}.legend .icon.points::after{background:#6dd5b4;border-radius:50%;content:"";display:block;height:7px;left:5px;position:absolute;top:-3px;width:7px}']}]}],t.ctorParameters=function(){return[{type:i.DomSanitizer}]},t.propDecorators={data:[{type:e.Input}]},t}();var b=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[d,h],imports:[n.CommonModule],exports:[d,h]}]}],t}();t.ChartsModule=b,t.LineChart=p,t.LineChartComponent=d,t.MultiLineChart=u,t.MultiLineChartComponent=h,t.MultiLineChartLineType={normal:"normal",dashed:"dashed",points:"points"},t.MultiLineChartValueType=c,t.prepareShapes=g,t.ɵa=o,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=wojtek1150-simple-charts.umd.min.js.map